{% extends 'finance/base.html' %}

{% block title %}{% if account %}Editar{% else %}Criar{% endif %} Conta - Finanças{% endblock %}

{% block content %}
        <h1>{% if account %}Editar{% else %}Criar{% endif %} Conta</h1>
        
        <form method="post">
            {% csrf_token %}
            
            <div>
                <label for="{{ form.name.id_for_label }}">{{ form.name.label }}</label>
                {{ form.name }}
                {% if form.name.errors %}
                    <div>{{ form.name.errors }}</div>
                {% endif %}
            </div>
            
            <div>
                <label for="{{ form.institution.id_for_label }}">{{ form.institution.label }}</label>
                {{ form.institution }}
                {% if form.institution.errors %}
                    <div>{{ form.institution.errors }}</div>
                {% endif %}
            </div>
            
            <div>
                <label for="{{ form.number.id_for_label }}">{{ form.number.label }}</label>
                {{ form.number }}
                {% if form.number.errors %}
                    <div>{{ form.number.errors }}</div>
                {% endif %}
            </div>
            
            <div>
                <label for="{{ form.account_type.id_for_label }}">{{ form.account_type.label }}</label>
                {{ form.account_type }}
                {% if form.account_type.errors %}
                    <div>{{ form.account_type.errors }}</div>
                {% endif %}
            </div>
            
            <div>
                <label for="{{ form.currency.id_for_label }}">{{ form.currency.label }}</label>
                {{ form.currency }}
                {% if form.currency.errors %}
                    <div>{{ form.currency.errors }}</div>
                {% endif %}
            </div>
            
            <div>
                <label for="{{ form.opening_balance.id_for_label }}">{{ form.opening_balance.label }}</label>
                {{ form.opening_balance }}
                {% if form.opening_balance.errors %}
                    <div>{{ form.opening_balance.errors }}</div>
                {% endif %}
            </div>
            
            <div>
                <label for="{{ form.minimum_balance.id_for_label }}">{{ form.minimum_balance.label }}</label>
                {{ form.minimum_balance }}
                {% if form.minimum_balance.errors %}
                    <div>{{ form.minimum_balance.errors }}</div>
                {% endif %}
            </div>
            
            <div>
                <label for="{{ form.group.id_for_label }}">{{ form.group.label }}</label>
                {{ form.group }}
                {% if form.group.errors %}
                    <div>{{ form.group.errors }}</div>
                {% endif %}
            </div>
            
            <div>
                <label for="{{ form.abbreviation.id_for_label }}">{{ form.abbreviation.label }}</label>
                {{ form.abbreviation }}
                {% if form.abbreviation.errors %}
                    <div>{{ form.abbreviation.errors }}</div>
                {% endif %}
            </div>
            
            <div>
                <label for="{{ form.comment.id_for_label }}">{{ form.comment.label }}</label>
                {{ form.comment }}
                {% if form.comment.errors %}
                    <div>{{ form.comment.errors }}</div>
                {% endif %}
            </div>
            
            <div>
                <label>
                    {{ form.is_favorite }}
                    {{ form.is_favorite.label }}
                </label>
                {% if form.is_favorite.errors %}
                    <div>{{ form.is_favorite.errors }}</div>
                {% endif %}
            </div>
            
            <div>
                <label>
                    {{ form.is_closed }}
                    {{ form.is_closed.label }}
                </label>
                {% if form.is_closed.errors %}
                    <div>{{ form.is_closed.errors }}</div>
                {% endif %}
            </div>
            
            <div id="card-fields" style="display: none;">
                <h2>Informações de Cartão de Crédito</h2>
                
                <div>
                    <label for="{{ form.cardholder.id_for_label }}">{{ form.cardholder.label }}</label>
                    {{ form.cardholder }}
                    {% if form.cardholder.errors %}
                        <div>{{ form.cardholder.errors }}</div>
                    {% endif %}
                </div>
                
                <div>
                    <label for="{{ form.card_number.id_for_label }}">{{ form.card_number.label }}</label>
                    {{ form.card_number }}
                    {% if form.card_number.help_text %}
                        <small>{{ form.card_number.help_text }}</small>
                    {% endif %}
                    {% if form.card_number.errors %}
                        <div>{{ form.card_number.errors }}</div>
                    {% endif %}
                </div>
                
                <div>
                    <label for="{{ form.expiration_date.id_for_label }}">{{ form.expiration_date.label }}</label>
                    {{ form.expiration_date }}
                    {% if form.expiration_date.errors %}
                        <div>{{ form.expiration_date.errors }}</div>
                    {% endif %}
                </div>
                
                <div>
                    <label for="{{ form.cvv.id_for_label }}">{{ form.cvv.label }}</label>
                    {{ form.cvv }}
                    {% if form.cvv.errors %}
                        <div>{{ form.cvv.errors }}</div>
                    {% endif %}
                </div>
                
                <div>
                    <label for="{{ form.brand.id_for_label }}">{{ form.brand.label }}</label>
                    {{ form.brand }}
                    {% if form.brand.errors %}
                        <div>{{ form.brand.errors }}</div>
                    {% endif %}
                </div>
            </div>
            
            <div>
                <button type="submit">Salvar</button>
                <a href="{% url 'finance:accounts_list' %}">Cancelar</a>
            </div>
        </form>
        
        <script>
            document.addEventListener('DOMContentLoaded', function() {
                const accountTypeSelect = document.getElementById('{{ form.account_type.id_for_label }}');
                const cardFields = document.getElementById('card-fields');
                
                function toggleCardFields() {
                    if (accountTypeSelect.value === 'CARD') {
                        cardFields.style.display = 'block';
                    } else {
                        cardFields.style.display = 'none';
                    }
                }
                
                // Verifica o valor inicial
                toggleCardFields();
                
                // Adiciona listener para mudanças
                accountTypeSelect.addEventListener('change', toggleCardFields);
            });
        </script>
{% endblock %}

